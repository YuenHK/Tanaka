<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A Tool for Manage Record.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>Tanaka</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="images/android-desktop.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Material Design Lite">
    <link rel="apple-touch-icon-precomposed" href="images/ios-desktop.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <link rel="shortcut icon" href="images/favicon.png">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.cyan-light_blue.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdui/0.4.3/css/mdui.css">
    <link rel="stylesheet" href="styles.css">
    <style>
    #view-source {
      position: fixed;
      display: block;
      right: 0;
      bottom: 0;
      margin-right: 40px;
      margin-bottom: 40px;
      z-index: 900;
    }
    </style>

  </head>
  <body>
    
    <div class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header ">
      <header class="demo-header mdl-layout__header mdl-color--grey-100 mdl-color-text--grey-600">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title">Tanaka</span>
          <div class="mdl-layout-spacer"></div>
          <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" id="hdrbtn">
            <i class="material-icons">more_vert</i>
          </button>
          <ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect mdl-menu--bottom-right" for="hdrbtn">
            <li class="mdl-menu__item" onclick='ShowAboutAlert()'>About</li>
          </ul>
        </div>
      </header>
      <div class="demo-drawer mdl-layout__drawer mdl-color--blue-grey-900 mdl-color-text--blue-grey-50">
        <header class="demo-drawer-header">
          <img id="userPhoto" src="images/user.jpg" class="demo-avatar">
          <div class="demo-avatar-dropdown">
            <span id="userEmail">Unknow</span>
            <div class="mdl-layout-spacer"></div>
            <button id="accbtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
              <i class="material-icons" role="presentation">arrow_drop_down</i>
              <span class="visuallyhidden">Accounts</span>
            </button>
            <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="accbtn">
              <li class="mdl-menu__item" onclick='logout()'><i class="material-icons">close</i>Logout</li>
            </ul>
          </div>
        </header>
        <nav class="demo-navigation mdl-navigation mdl-color--blue-grey-800">
          <a class="mdl-navigation__link" href="index.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">home</i>主頁</a>
          <a class="mdl-navigation__link" href="case.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">inbox</i>紀錄</a>
          <a class="mdl-navigation__link" href="setting.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">flag</i>設定</a>
          <a class="mdl-navigation__link" href="authority.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">people</i>權限</a>
          <a class="mdl-navigation__link" href="store.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">store</i>庫存</a>
        </nav>
      </div>

      <!-- Top Card -->
      <main class="demo-cards mdl-color--grey-100 ">
        <div class="mdl-grid demo-content">
          <div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
            <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
              <div class="mdl-card__title mdl-card--expand mdl-color--teal-300">
                <h2 class="mdl-card__title-text">事項管理</h2>
              </div>
              <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                你可在本頁刪除&修改&査看全部回報事項。
              </div>
            </div>
            <div class="demo-separator mdl-cell--1-col"></div>
          </div>
          
        </div>
      </main>
      <!-- End Top Card -->

      <!-- Item List -->
      <main class="demo-cards mdl-color--grey-100 ">
        <div class="mdl-grid demo-content">
          <div class="mdui-table-hoverable mdui-table-fluid demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
            <table class="mdui-table" id="tableList" name="tableList">
              <thead>
                <tr>
                  <th>類型</th>
                  <th>項目名稱</th>
                  <th>地點</th>
                  <th>緊急度</th>
                  <th>進度</th>
                  <th>回報者</th>
                  <th>回報時間</th>
                  <th>完成時間</th>
                  <th>備注</th>
                  <th>刪除</th>
                </tr>
              </thead>
              <tbody name="ITitemList" id="ITitemList" >
      
              </tbody>
              </table>
          </div>
        </main>
        <!-- End Item List -->

        <!-- Low Right Button -->
        <button class="mdui-fab mdui-fab-fixed mdui-ripple" onclick="table2excel()"><i class="mdui-icon material-icons">file_download</i></button>

      <!-- About Box -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="Aboutdialog" >
          <div class="mdui-dialog-title">About</div>
          <div class="mdui-dialog-content">Tanaka：維修項目管理工具 @2020</div>
          <div class="mdui-dialog-actions">
            <button type="button" class="mdui-btn mdui-ripple" onclick="window.open('https://github.com/YuenHK')" mdui-dialog-confirm>Github</button>
          </div>
        </div>
      </div>
      <!-- End About Box -->

      <!-- Login Box -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="Logindialog" >
          <div class="mdui-dialog-title">請先使用本校Google帳户登入，再繼續使用</div>
          <div class="mdui-dialog-content">注意並批准彈出視窗，以確保順利登入。如無彈出視窗，按下登入</div>
          <div class="mdui-dialog-actions">
            <button id="LoginBtn" name=" " class="mdui-btn mdui-ripple" onclick='login()' mdui-dialog-confirm>登入</button>
          </div>
        </div>
      </div>
      <!-- End Login Box -->

      <!-- Delete Box-->
      <div class="mdui-container">
        <div class="mdui-dialog" id="deletelog">
          <div class="mdui-dialog-title">刪除案件</div>
          <div class="mdui-dialog-content" name="ShowDeleteAlertText" id="ShowDeleteAlertText"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertDelete" name=" " class="mdui-btn mdui-ripple" onclick="DeleteItem(this)" mdui-dialog-confirm>刪除</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Delete Box-->

      <!-- Alert Box -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="dialog">
          <div class="mdui-dialog-title">更改項目緊急度</div>
          <div class="mdui-dialog-content" name="ShowAlertText" id="ShowAlertText"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertLevel0" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel0(this)" mdui-dialog-confirm>非緊急</button>
            <button id="AlertLevel1" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel1(this)"mdui-dialog-confirm>次緊急</button>
            <button id="AlertLevel2" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel2(this)"mdui-dialog-confirm>好緊急</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Alert Box -->

      <!-- Alert Box for State -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="statelog">
          <div class="mdui-dialog-title">更改項目進度</div>
          <div class="mdui-dialog-content" name="ShowStateAlertText" id="ShowStateAlertText"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertState0" name=" " class="mdui-btn mdui-ripple" onclick="ChangeState0(this)" mdui-dialog-confirm>待處理</button>
            <button id="AlertState1" name=" " class="mdui-btn mdui-ripple" onclick="ChangeState1(this)"mdui-dialog-confirm>處理中</button>
            <button id="AlertState2" name=" " class="mdui-btn mdui-ripple" onclick="ChangeState2(this)"mdui-dialog-confirm>已完成</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Alert Box for IT -->

    </div>
      
    <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdui/0.4.3/js/mdui.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src="jquery.table2excel.js"></script>


    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-firestore.js">
      const firebase = require("firebase");
      require("firebase/firestore");
    </script>

    <script>
    // Web app's Firebase configuration
    firebase.initializeApp({
      apiKey: 'AIzaSyC6PAQwu2C7NuYFFlKnUzMQ-tU2VlkEuGg',
      authDomain: 'tanaka-d99d7.firebaseapp.com',
      projectId: 'tanaka-d99d7'
    });

    var db = firebase.firestore();

    var provider = new firebase.auth.GoogleAuthProvider();
    var profile_displayName;
    var profile_email;
    var profile_photoURL;

    //Login with Google
    login();
    function login(){
      firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        CloseLoginAlert();
        // User is signed in.
        profile_displayName = user.displayName;
        profile_email = user.email;
        profile_photoURL = user.photoURL;

        ReadCaseList(user.displayName);
        console.log("Finded a user, Import Profile \n" + profile_displayName + "\n" + profile_email + "\n" + profile_photoURL);
        document.getElementById("userEmail").innerHTML = profile_displayName + "\n" + profile_email;
        document.getElementById("userPhoto").setAttribute("src", user.photoURL);

      }else {
        ShowLoginAlert();
        firebase.auth().signInWithPopup(provider).then(function(result) {
        // This gives you a Google Access Token. You can use it to access the Google API.
        var token = result.credential.accessToken;
        var user = result.user;
        var name = user.displayName;
        var email = user.email;
        var photoUrl = user.photoURL;
        profile_displayName = user.displayName;
        profile_email = user.email;
        profile_photoURL = user.photoURL;
        console.log("user logined \n" + profile_displayName + "\n" + profile_email + "\n" + profile_photoURL);
      }).catch(function(error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        // The email of the user's account used.
        var email = error.email;
        // The firebase.auth.AuthCredential type that was used.
        var credential = error.credential;
      });};
    });}
    
    //Logout with Google
    function logout(){
    firebase.auth().signOut().then(function() {
      // Sign-out successful.
      profile_displayName = null;
      profile_email = null;
      profile_photoURL = null;
    }).catch(function(error) {
      // An error happened.
      profile_displayName = null;
      profile_email = null;
      profile_photoURL = null;
    });

    }

    //Read Case List to Table
    function ReadCaseList(user){
      var userName = user;

      var DeleteButton;
      var ref = db.collection("Case").orderBy("StartTimestamp", "desc");
      ref.onSnapshot(querySnapshot => {
        var html;
        var timeToString;
        querySnapshot.forEach(doc => {
          console.log(doc);
          var cutStartTimestamp = doc.data().StartTimestamp.substring(0,doc.data().StartTimestamp.search("GMT")-1);
          var cutEndTimestamp = doc.data().EndTimestamp.substring(0,doc.data().EndTimestamp.search("GMT")-1);
          if (doc.data().Type == 0){
            html = html + '<tr><td>電子設備</td>';
          } else if (doc.data().Type == 1){
            html = html + '<tr><td>校舍維修</td>';
          }
          html = html + '<td>' + doc.data().Name + '</td><td>' + doc.data().Location + '</td>';
          if (doc.data().Level == 0){
            html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-teal-500" onclick="ShowAlert(this)");">非緊急</button></td>';
          } else if (doc.data().Level == 1){
            html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-light-blue-a700" onclick="ShowAlert(this)");">次緊急</button></td>';
          }else if (doc.data().Level == 2){
            html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-pink-accent" onclick="ShowAlert(this)");">好緊急</button></td>';
          }
          if (doc.data().State == 0){
            html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '"class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowStateAlert(this)");">待處理</button></td>';
          } else if (doc.data().State == 1){
            html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '"class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowStateAlert(this)");">處理中</button></td>';
          }else if (doc.data().State == 2){
            html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '"class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowStateAlert(this)");">已完成</button></td>';
          }
          html = html + '<td>' + doc.data().Reporter + '</td>';
          html = html + '<td>' + cutStartTimestamp  + '</td><td>' + cutEndTimestamp + '</td>';
          html = html + '<td>' + doc.data().Remark + '</td>';
          html = html + '<td><button id="' + doc.data().Name + '" name="' + doc.data().StartTimestamp + '"class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowDeleteAlert(this)");">&#xe92b;</button></td></tr>'
          console.log(doc.data().Name);
        });

        document.getElementById("ITitemList").innerHTML = html;
        mdui.mutation();
      });
      
    }

var inst = new mdui.Dialog('#dialog');
var instState = new mdui.Dialog('#statelog');
var instLogin = new mdui.Dialog('#Logindialog');
var instAbout = new mdui.Dialog('#Aboutdialog');
var instDelete = new mdui.Dialog('#deletelog');

// method for Open Delete AlertBox
function ShowDeleteAlert(myObj){
  document.getElementById("ShowDeleteAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請再次確定刪除，或按取消退出";
  document.getElementById("AlertDelete").setAttribute("name", myObj.name);
  instDelete.open();
}

// method for Open AlertBox 
function ShowAlert(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  document.getElementById("AlertLevel0").setAttribute("name", myObj.name);
  document.getElementById("AlertLevel1").setAttribute("name", myObj.name);
  document.getElementById("AlertLevel2").setAttribute("name", myObj.name);
  inst.open();
}

// method for Open State AlertBox 
function ShowStateAlert(myObj){
  document.getElementById("ShowStateAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的進度，或按取消退出";
  document.getElementById("AlertState0").setAttribute("name", myObj.name);
  document.getElementById("AlertState1").setAttribute("name", myObj.name);
  document.getElementById("AlertState2").setAttribute("name", myObj.name);
  instState.open();
}

// ShowAlertButton_Functiom 改非緊急
function ChangeLevel0(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Case").doc(myObj.name).update({
        Level: 0,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadCaseList();  
}

// ShowAlertButton_Functiom 改次緊急
function ChangeLevel1(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Case").doc(myObj.name).update({
        Level: 1,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadCaseList();
}

// ShowAlertButton_Functiom 改好緊急
function ChangeLevel2(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Case").doc(myObj.name).update({
        Level: 2,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadCaseList(); 
}

// ShowAlertButton_Functiom 改待處理
function ChangeState0(myObj){
  document.getElementById("ShowStateAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Case").doc(myObj.name).update({
        State: 0,
        EndTimestamp: ""
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '進度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '進度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadCaseList();  
}

// ShowAlertButton_Functiom 改處理中
function ChangeState1(myObj){
  document.getElementById("ShowStateAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Case").doc(myObj.name).update({
        State: 1,
        EndTimestamp: ""
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '進度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '進度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadCaseList();
}

// ShowAlertButton_Functiom 改已完成
function ChangeState2(myObj){
  document.getElementById("ShowStateAlertText").innerHTML = "你選擇了【 " + myObj.name + " : " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  var Time = new Date().toUTCString();
  db.collection("Case").doc(myObj.name).update({
        State: 2,
        EndTimestamp: Time
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '進度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '進度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadCaseList(); 
}


// ShowDeleteAlertButton_Functiom 刪除項目
function DeleteItem(myObj){
  var db = firebase.firestore();
  let Ref = db.collection("Case").doc(myObj.name)
  Ref.delete().then(function() {
      console.log('Document successfully deleted!');
      mdui.snackbar({
          message: '項目刪除成功',
          position: 'bottom',
          timeout: 3000
      });
  }).catch(function(error) {
      console.error('Error removing document: ', error)
      mdui.snackbar({
          message: '項目刪除失敗',
          position: 'bottom',
          timeout: 3000
      });
  })
      ReadITitemList();
      
}

// method for Open About AlertBox 
function ShowAboutAlert(){
  instAbout.open();
}

// method for Open Login AlertBox 
function ShowLoginAlert(){
  instLogin.open();
}

// method for Close Login AlertBox 
function CloseLoginAlert(){
  instLogin.close();
}

// event for Login Box 
var Logindialog = document.getElementById('Logindialog');

Logindialog.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

Logindialog.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

Logindialog.addEventListener('close.mdui.dialog', function () {
  console.log('close');
  firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        // User is signed in.
      }else {
        ShowLoginAlert();
        login();
        };
    });
});

Logindialog.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

Logindialog.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

Logindialog.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

// event for AlertDeleteBox 
var deletelog = document.getElementById('deletelog');

deletelog.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

deletelog.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

deletelog.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

deletelog.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

deletelog.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

deletelog.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

// event for AlertStateBox 
var statelog = document.getElementById('statelog');

statelog.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

statelog.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

statelog.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

statelog.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

statelog.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

statelog.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

//Table to Excel
function table2excel(){
  $("#tableList").table2excel({
    exclude : ".noExl",
    filename : "Record_"  + new Date().getTime()  + ".xls",
    name: "Excel Document Name.xlsx",
    exclude_img: true,
    exclude_links: true,
    exclude_inputs: true
  });
}




  </script>

  </body>
</html>
