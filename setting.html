<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>Tanaka</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="images/android-desktop.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Material Design Lite">
    <link rel="apple-touch-icon-precomposed" href="images/ios-desktop.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <link rel="shortcut icon" href="images/favicon.png">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.cyan-light_blue.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdui/0.4.3/css/mdui.css">
    <link rel="stylesheet" href="styles.css">
    <style>
    #view-source {
      position: fixed;
      display: block;
      right: 0;
      bottom: 0;
      margin-right: 40px;
      margin-bottom: 40px;
      z-index: 900;
    }
    </style>

  </head>
  <body>
    
    <div class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header ">
      <header class="demo-header mdl-layout__header mdl-color--grey-100 mdl-color-text--grey-600">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title">Tanaka</span>
          <div class="mdl-layout-spacer"></div>
          <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" id="hdrbtn">
            <i class="material-icons">more_vert</i>
          </button>
          <ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect mdl-menu--bottom-right" for="hdrbtn">
            <li class="mdl-menu__item" onclick='ShowAboutAlert()'>About</li>
          </ul>
        </div>
      </header>
      <div class="demo-drawer mdl-layout__drawer mdl-color--blue-grey-900 mdl-color-text--blue-grey-50">
        <header class="demo-drawer-header">
          <img id="userPhoto" src="images/user.jpg" class="demo-avatar">
          <div class="demo-avatar-dropdown">
            <span id="userEmail">Unknow</span>
            <div class="mdl-layout-spacer"></div>
            <button id="accbtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
              <i class="material-icons" role="presentation">arrow_drop_down</i>
              <span class="visuallyhidden">Accounts</span>
            </button>
            <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="accbtn">
              <li class="mdl-menu__item" onclick='logout()'><i class="material-icons">close</i>Logout</li>
            </ul>
          </div>
        </header>
        <nav class="demo-navigation mdl-navigation mdl-color--blue-grey-800">
          <a class="mdl-navigation__link" href="index.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">home</i>主頁</a>
          <a class="mdl-navigation__link" href="case.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">inbox</i>紀錄</a>
          <a class="mdl-navigation__link" href="setting.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">flag</i>設定</a>
          <a class="mdl-navigation__link" href="authority.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">people</i>權限</a>
        </nav>
      </div>

      <!-- Top Card -->
      <main class="demo-cards mdl-color--grey-100 ">
        <div class="mdl-grid demo-content">
          <div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
            <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
              <div class="mdl-card__title mdl-card--expand mdl-color--teal-300">
                <h2 class="mdl-card__title-text">管理項目</h2>
              </div>
              <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                你可在本頁增加&刪除&修改資料庫項目。
              </div>
            </div>
            <div class="demo-separator mdl-cell--1-col"></div>
          </div>
          
        </div>
      </main>
      <!-- End Top Card -->

      <!-- Add Item -->
      <main class="demo-cards mdl-color--grey-100 ">
        <div class="mdl-grid demo-content">
          <div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">

            <form action="#" class="mdui-container mdui-col-xs-12 mdui-col-xs-12 mdui-theme-primary-indigo mdui-theme-accent-pink">
            
              <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdui-col-xs-2">
                <select class="mdui-select" mdui-select name="Type" id="Type" >
                  <option value="0">電子設備</option>
                  <option value="1">校舍維修</option>
                </select>
              </div>
            
              <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdui-col-xs-2">
                <select class="mdui-select" mdui-select name="Level" id="Level" >
                  <option value="0">非緊急</option>
                  <option value="1">次緊急</option>
                  <option value="2">好緊急</option>
                </select>
              </div>

              <div class="mdui-textfield">
                <input class="mdui-textfield-input" type="text" placeholder="項目名稱" name="Name" id="Name" required/>
              </div>

              <button type="button" class="mdui-container mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent mdui-col-xs-12" onclick="addItem()">增加項目</button>

            </form>
            
            <div class="demo-separator mdl-cell--1-col"></div>
          </div>
          
        </div>
      </main>
      <!-- End Add Item -->

      <!-- Add Location -->
      <main class="demo-cards mdl-color--grey-100 ">
        <div class="mdl-grid demo-content">
          <div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">

            <form action="#" class="mdui-container mdui-col-xs-12 mdui-col-xs-12 mdui-theme-primary-indigo mdui-theme-accent-pink">

              <div class="mdui-textfield">
                <input class="mdui-textfield-input" type="text" placeholder="校園地點" name="LocationInput" id="LocationInput" required/>
              </div>

              <button type="button" class="mdui-container mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent mdui-col-xs-12" onclick="addLocation()">增加地點</button>

            </form>
            
            <div class="demo-separator mdl-cell--1-col"></div>
          </div>
          
        </div>
      </main>
      <!-- End Location -->

      <main class="demo-cards mdl-color--grey-100 ">
        <div class="mdl-grid demo-content">
          <div class="mdui-table-hoverable mdui-table-fluid demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
            <div class="mdui-panel mdui-panel-popout" mdui-panel>

              <div class="mdui-panel-item">
                <div class="mdui-panel-item-header">展開顯示 / 縮放隱藏 電子設備目錄</div>
                <div class="mdui-panel-item-body">
                  <!-- Item List for IT -->
                  <main class="demo-cards mdl-color--grey-100 ">
                  <div class="mdl-grid demo-content">
                    <div class="mdui-table-hoverable mdui-table-fluid demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
                      <table class="mdui-table" >
                        <thead>
                          <tr>
                            <th>項目名稱</th>
                            <th>緊急度</th>
                            <th>刪除</th>
                          </tr">
                        </thead>
                        <tbody name="ITitemList" id="ITitemList" >
                
                        </tbody>
                        </table>
                    </div>
                    </main>
                    <!-- End Item List for IT -->
                </div>
              </div>
              
              <div class="mdui-panel-item">
                <div class="mdui-panel-item-header">展開顯示 / 縮放隱藏 校舍維修目錄</div>
                <div class="mdui-panel-item-body">
                  <!-- Item List for Construction -->
                  <main class="demo-cards mdl-color--grey-100 ">
                  <div class="mdl-grid demo-content">
                    <div class="mdui-table-hoverable mdui-table-fluid demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
                      <table class="mdui-table" >
                        <thead>
                          <tr>
                            <th>項目名稱</th>
                            <th>緊急度</th>
                            <th>刪除項目</th>
                          </tr">
                        </thead>
                        <tbody name="ConstructionitemList" id="ConstructionitemList" >
                
                        </tbody>
                        </table>
                    </div>
                    </main>
                    <!-- End Item List for Construction -->
                </div>
              </div>
              
              <div class="mdui-panel-item">
                <div class="mdui-panel-item-header">展開顯示 / 縮放隱藏 校園地點目錄</div>
                <div class="mdui-panel-item-body">
                  <!-- Item List for Location -->
                  <main class="demo-cards mdl-color--grey-100 ">
                  <div class="mdl-grid demo-content">
                    <div class="mdui-table-hoverable mdui-table-fluid demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
                      <table class="mdui-table" >
                        <thead>
                          <tr>
                            <th>地點名稱</th>
                            <th>刪除地點</th>
                          </tr">
                        </thead>
                        <tbody name="LocationitemList" id="LocationitemList" >
                
                        </tbody>
                        </table>
                    </div>
                    </main>
                    <!-- End Item List for Location -->
                </div>
              </div>
              
            </div>
          </div>
      </main>

      <!-- About Box -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="Aboutdialog" >
          <div class="mdui-dialog-title">About</div>
          <div class="mdui-dialog-content">Tanaka：維修項目管理工具 @2020</div>
          <div class="mdui-dialog-actions">
            <button type="button" class="mdui-btn mdui-ripple" onclick="window.open('https://github.com/YuenHK')" mdui-dialog-confirm>Github</button>
          </div>
        </div>
      </div>
      <!-- End About Box -->

      <!-- Login Box -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="Logindialog" >
          <div class="mdui-dialog-title">請先登入再繼續使用</div>
          <div class="mdui-dialog-content">注意並批准彈出視窗，以確保順利登入。如無彈出視窗，按下登入</div>
          <div class="mdui-dialog-actions">
            <button id="LoginBtn" name=" " class="mdui-btn mdui-ripple" onclick='login()' mdui-dialog-confirm>登入</button>
          </div>
        </div>
      </div>
      <!-- End Login Box -->

      <!-- Alert Box for IT -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="dialog">
          <div class="mdui-dialog-title">更改項目緊急度</div>
          <div class="mdui-dialog-content" name="ShowAlertText" id="ShowAlertText"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertLevel0" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel0(this)" mdui-dialog-confirm>非緊急</button>
            <button id="AlertLevel1" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel1(this)"mdui-dialog-confirm>次緊急</button>
            <button id="AlertLevel2" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel2(this)"mdui-dialog-confirm>好緊急</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Alert Box for IT -->

      <!-- Alert Box for C -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="dialogC">
          <div class="mdui-dialog-title">更改項目緊急度</div>
          <div class="mdui-dialog-content" name="ShowAlertTextC" id="ShowAlertTextC"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertLevel0C" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel0C(this)" mdui-dialog-confirm>非緊急</button>
            <button id="AlertLevel1C" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel1C(this)"mdui-dialog-confirm>次緊急</button>
            <button id="AlertLevel2C" name=" " class="mdui-btn mdui-ripple" onclick="ChangeLevel2C(this)"mdui-dialog-confirm>好緊急</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Alert Box for C -->

      <!-- Delete Box for IT -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="deletelog">
          <div class="mdui-dialog-title">刪除項目</div>
          <div class="mdui-dialog-content" name="ShowDeleteAlertText" id="ShowDeleteAlertText"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertDelete" name=" " class="mdui-btn mdui-ripple" onclick="DeleteItem(this)" mdui-dialog-confirm>刪除</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Delete Box for IT -->

      <!-- Delete Box for C -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="deletelogC">
          <div class="mdui-dialog-title">刪除項目</div>
          <div class="mdui-dialog-content" name="ShowDeleteAlertTextC" id="ShowDeleteAlertTextC"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertDeleteC" name=" " class="mdui-btn mdui-ripple" onclick="DeleteItemC(this)" mdui-dialog-confirm>刪除</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Delete Box for C -->

      <!-- Delete Box for Location -->
      <div class="mdui-container">
        <div class="mdui-dialog" id="deletelogLocation">
          <div class="mdui-dialog-title">刪除項目</div>
          <div class="mdui-dialog-content" name="ShowDeleteAlertTextLocation" id="ShowDeleteAlertTextLocation"></div>
          <div class="mdui-dialog-actions">
            <button id="AlertDeleteLocation" name=" " class="mdui-btn mdui-ripple" onclick="DeleteItemLocation(this)" mdui-dialog-confirm>刪除</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          </div>
        </div>
      </div>
      <!-- End Delete Box for Location -->

    </div>
      
    <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdui/0.4.3/js/mdui.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-firestore.js">
      const firebase = require("firebase");
      require("firebase/firestore");
    </script>

    <script>
    // Web app's Firebase configuration
    firebase.initializeApp({
      apiKey: 'AIzaSyC6PAQwu2C7NuYFFlKnUzMQ-tU2VlkEuGg',
      authDomain: 'tanaka-d99d7.firebaseapp.com',
      projectId: 'tanaka-d99d7'
    });

    var db = firebase.firestore();

    var provider = new firebase.auth.GoogleAuthProvider();
    var profile_displayName;
    var profile_email;
    var profile_photoURL;

    //Login with Google
    login();
    function login(){
      firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        CloseLoginAlert();
        // User is signed in.
        profile_displayName = user.displayName;
        profile_email = user.email;
        profile_photoURL = user.photoURL;

        console.log("Finded a user, Import Profile \n" + profile_displayName + "\n" + profile_email + "\n" + profile_photoURL);

        document.getElementById("userEmail").innerHTML = profile_displayName + "\n" + profile_email;
        document.getElementById("userPhoto").setAttribute("src", user.photoURL);

      }else {
        ShowLoginAlert();
        firebase.auth().signInWithPopup(provider).then(function(result) {
        // This gives you a Google Access Token. You can use it to access the Google API.
        var token = result.credential.accessToken;
        var user = result.user;
        var name = user.displayName;
        var email = user.email;
        var photoUrl = user.photoURL;
        profile_displayName = user.displayName;
        profile_email = user.email;
        profile_photoURL = user.photoURL;
        console.log("user logined \n" + profile_displayName + "\n" + profile_email + "\n" + profile_photoURL);
      }).catch(function(error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        // The email of the user's account used.
        var email = error.email;
        // The firebase.auth.AuthCredential type that was used.
        var credential = error.credential;
      });};
    });}
    
    //Logout with Google
    function logout(){
    firebase.auth().signOut().then(function() {
      // Sign-out successful.
      profile_displayName = null;
      profile_email = null;
      profile_photoURL = null;
    }).catch(function(error) {
      // An error happened.
      profile_displayName = null;
      profile_email = null;
      profile_photoURL = null;
    });
    }
    
    // Add Item
    function addItem(){
      var inputType = document.getElementById("Type");
      var inputTypeStr = inputType.options[inputType.selectedIndex].value;
      var inputLevel = document.getElementById("Level");
      var inputLevelStr = inputLevel.options[inputLevel.selectedIndex].value;
      var inputName = document.getElementById("Name").value;

      // Add Item To IT List
      if(inputTypeStr == "0" && inputName.length > 0) {
        db.collection("Setting").doc("IT").collection("Detail").doc(inputName).set({
        Type: inputTypeStr,
        Level: inputLevelStr,
        Name: inputName
      })
      .then(function(docRef) {
        console.log("Add Data Successful["+"inputTypeStr: "+inputTypeStr+" inputLevelStr: "+inputLevelStr+" inputName: "+inputName+"]");
        mdui.snackbar({
          message: '項目增加成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Error adding document: ", error);
        mdui.snackbar({
          message: '項目增加失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadITitemList();

      // Add Item To Construction List
      } else if(inputTypeStr == "1" && inputName.length > 0) {
        db.collection("Setting").doc("Construction").collection("Detail").doc(inputName).set({
        Type: inputTypeStr,
        Level: inputLevelStr,
        Name: inputName
      })
      .then(function(docRef) {
        console.log("Add Data Successful["+"inputTypeStr: "+inputTypeStr+" inputLevelStr: "+inputLevelStr+" inputName: "+inputName+"]");
        mdui.snackbar({
          message: '項目增加成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Error adding document: ", error);
        mdui.snackbar({
          message: '項目增加失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadConstructionitemList();
      }

    };

    // Add Location
    function addLocation(){
      var inputLocation = document.getElementById("LocationInput").value;
      if(inputLocation.length > 0) {
        db.collection("Setting").doc("Location").collection("Detail").doc(inputLocation).set({
          Location: inputLocation
      })
      .then(function(docRef) {
        console.log("Add Data Successful["+"inputLocation: "+inputLocation+"]");
        mdui.snackbar({
          message: '地點增加成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Error adding document: ", error);
        mdui.snackbar({
          message: '地點增加失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      }
      ReadLocationitemList();
    };

    //Read IT Item List to Table
    ReadITitemList();
    function ReadITitemList(){
      var html;
      var LevelOneSelect;
      var Level1neSelect;
      var Level2neSelect;
      var DeleteButton;
      var ref = db.collection("Setting").doc("IT").collection("Detail");
      ref.onSnapshot(querySnapshot => {
        querySnapshot.forEach(doc => {
          html = html + '<tr><td>' + doc.data().Name + '</td>';
          LevelOneSelect = '<td><button id="' + doc.data().Name + '" name="' + doc.data().Name + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-teal-500" onclick="ShowAlert(this)");">非緊急</button></td>';
          Level1neSelect = '<td><button id="' + doc.data().Name + '" name="' + doc.data().Name + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-light-blue-a700" onclick="ShowAlert(this)");">次緊急</button></td>';
          Level2neSelect = '<td><button id="' + doc.data().Name + '" name="' + doc.data().Name + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-pink-accent" onclick="ShowAlert(this)");">好緊急</button></td>';
          DeleteButton = '<td><button id="' + doc.data().Name + '_Delete" name="' + doc.data().Name + '" class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowDeleteAlert(this)");">&#xe92b;</button></td></tr>'
          if (doc.data().Level == 0){
            html = html + LevelOneSelect + DeleteButton;
          } else if (doc.data().Level == 1){
            html = html + Level1neSelect + DeleteButton;
          }else if (doc.data().Level == 2){
            html = html + Level2neSelect + DeleteButton;
          }
          console.log(doc.data().Name);
        });
        document.getElementById("ITitemList").innerHTML = html;
        mdui.mutation();
      });
    }

    //Read Construction Item List to Table
    ReadConstructionitemList();
    function ReadConstructionitemList(){
      var html;
      var LevelOneSelect;
      var Level1neSelect;
      var Level2neSelect;
      var DeleteButton;
      var ref = db.collection("Setting").doc("Construction").collection("Detail");
      ref.onSnapshot(querySnapshot => {
        querySnapshot.forEach(doc => {
          html = html + '<tr><td>' + doc.data().Name + '</td>';
          LevelOneSelect = '<td><button id="' + doc.data().Name + '" name="' + doc.data().Name + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-teal-500" onclick="ShowAlertC(this)");">非緊急</button></td>';
          Level1neSelect = '<td><button id="' + doc.data().Name + '" name="' + doc.data().Name + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-light-blue-a700" onclick="ShowAlertC(this)");">次緊急</button></td>';
          Level2neSelect = '<td><button id="' + doc.data().Name + '" name="' + doc.data().Name + '" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-pink-accent" onclick="ShowAlertC(this)");">好緊急</button></td>';
          DeleteButton = '<td><button id="' + doc.data().Name + '_Delete" name="' + doc.data().Name + '" class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowDeleteAlertC(this)");">&#xe92b;</button></td></tr>'
          if (doc.data().Level == 0){
            html = html + LevelOneSelect + DeleteButton;
          } else if (doc.data().Level == 1){
            html = html + Level1neSelect + DeleteButton;
          }else if (doc.data().Level == 2){
            html = html + Level2neSelect + DeleteButton;
          }
          console.log(doc.data().Name);
        });
        document.getElementById("ConstructionitemList").innerHTML = html;
        mdui.mutation();
      });
    }

    //Read Location Item List to Table
    ReadLocationitemList();
    function ReadLocationitemList(){
      var html;
      var DeleteButton;
      var ref = db.collection("Setting").doc("Location").collection("Detail");
      ref.onSnapshot(querySnapshot => {
        querySnapshot.forEach(doc => {
          html = html + '<tr><td>' + doc.data().Location + '</td>';
          DeleteButton = '<td><button id="' + doc.data().Location + '_Delete" name="' + doc.data().Location + '" class=" mdui-icon material-icons mdui-btn mdui-btn-raised mdui-ripple" onclick="ShowDeleteAlertLocation(this)");">&#xe92b;</button></td></tr>'
          html = html = html + DeleteButton;
          console.log(doc.data().Location);
        });
        document.getElementById("LocationitemList").innerHTML = html;
        mdui.mutation();
      });
    }

var inst = new mdui.Dialog('#dialog');
var instDelete = new mdui.Dialog('#deletelog');
var instC = new mdui.Dialog('#dialogC');
var instDeleteC = new mdui.Dialog('#deletelogC');
var instDeleteLocation = new mdui.Dialog('#deletelogLocation');
var instLogin = new mdui.Dialog('#Logindialog');
var instAbout = new mdui.Dialog('#Aboutdialog');

// method for Open About AlertBox 
function ShowAboutAlert(){
  instAbout.open();
}

// method for Open Login AlertBox 
function ShowLoginAlert(){
  instLogin.open();
}

// method for Close Login AlertBox 
function CloseLoginAlert(){
  instLogin.close();
}

// method for Open AlertBox for IT 
function ShowAlert(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  document.getElementById("AlertLevel0").setAttribute("name", myObj.id);
  document.getElementById("AlertLevel1").setAttribute("name", myObj.id);
  document.getElementById("AlertLevel2").setAttribute("name", myObj.id);
  inst.open();
}

// method for Open AlertBox for C 
function ShowAlertC(myObj){
  document.getElementById("ShowAlertTextC").innerHTML = "你選擇了【 " + myObj.id + " 】。請選擇更改的緊急度，或按取消退出";
  document.getElementById("AlertLevel0C").setAttribute("name", myObj.id);
  document.getElementById("AlertLevel1C").setAttribute("name", myObj.id);
  document.getElementById("AlertLevel2C").setAttribute("name", myObj.id);
  instC.open();
}

// method for Open Delete AlertBox for IT 
function ShowDeleteAlert(myObj){
  document.getElementById("ShowDeleteAlertText").innerHTML = "你選擇了【 " + myObj.name + " 】。請再次確定刪除，或按取消退出";
  document.getElementById("AlertDelete").setAttribute("name", myObj.name);
  instDelete.open();
}

// method for Open Delete AlertBox for C 
function ShowDeleteAlertC(myObj){
  document.getElementById("ShowDeleteAlertTextC").innerHTML = "你選擇了【 " + myObj.name + " 】。請再次確定刪除，或按取消退出";
  document.getElementById("AlertDeleteC").setAttribute("name", myObj.name);
  instDeleteC.open();
}

// method for Open Delete AlertBox for Location 
function ShowDeleteAlertLocation(myObj){
  document.getElementById("ShowDeleteAlertTextLocation").innerHTML = "你選擇了【 " + myObj.name + " 】。請再次確定刪除，或按取消退出";
  document.getElementById("AlertDeleteLocation").setAttribute("name", myObj.name);
  instDeleteLocation.open();
}

// ShowDeleteAlertButton_Functiom for IT 刪除項目
function DeleteItem(myObj){
  var db = firebase.firestore();
  let Ref = db.collection("Setting").doc("IT").collection("Detail").doc(myObj.name)
  Ref.delete().then(function() {
      console.log('Document successfully deleted!');
      mdui.snackbar({
          message: '項目刪除成功',
          position: 'bottom',
          timeout: 3000
      });
  }).catch(function(error) {
      console.error('Error removing document: ', error)
      mdui.snackbar({
          message: '項目刪除失敗',
          position: 'bottom',
          timeout: 3000
      });
  })
      ReadITitemList();
      
}

// ShowDeleteAlertButton_Functiom for C 刪除項目
function DeleteItemC(myObj){
  var db = firebase.firestore();
  let Ref = db.collection("Setting").doc("Construction").collection("Detail").doc(myObj.name)
  Ref.delete().then(function() {
      console.log('Document successfully deleted!');
      mdui.snackbar({
          message: '項目刪除成功',
          position: 'bottom',
          timeout: 3000
      });
  }).catch(function(error) {
      console.error('Error removing document: ', error)
      mdui.snackbar({
          message: '項目刪除失敗',
          position: 'bottom',
          timeout: 3000
      });
  })
      ReadConstructionitemList();
      
}

// ShowDeleteAlertButton_Functiom for Location 刪除項目
function DeleteItemLocation(myObj){
  var db = firebase.firestore();
  let Ref = db.collection("Setting").doc("Location").collection("Detail").doc(myObj.name)
  Ref.delete().then(function() {
      console.log('Document successfully deleted!');
      mdui.snackbar({
          message: '項目刪除成功',
          position: 'bottom',
          timeout: 3000
      });
  }).catch(function(error) {
      console.error('Error removing document: ', error)
      mdui.snackbar({
          message: '項目刪除失敗',
          position: 'bottom',
          timeout: 3000
      });
  })
      ReadLocationitemList();
      
}

// ShowAlertButton_Functiom for IT 改非緊急
function ChangeLevel0(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Setting").doc("IT").collection("Detail").doc(myObj.name).update({
        Level: 0,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadITitemList();
      
}

// ShowAlertButton_Functiom for C 改非緊急
function ChangeLevel0C(myObj){
  document.getElementById("ShowAlertTextC").innerHTML = "你選擇了【 " + myObj.name + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Setting").doc("Construction").collection("Detail").doc(myObj.name).update({
        Level: 0,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadConstructionitemList();
      
}

// ShowAlertButton_Functiom for IT 改次緊急
function ChangeLevel1(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Setting").doc("IT").collection("Detail").doc(myObj.name).update({
        Level: 1,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadITitemList();
      
}

// ShowAlertButton_Functiom for C 改次緊急
function ChangeLevel1C(myObj){
  document.getElementById("ShowAlertTextC").innerHTML = "你選擇了【 " + myObj.name + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Setting").doc("Construction").collection("Detail").doc(myObj.name).update({
        Level: 1,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadConstructionitemList();
      
}

// ShowAlertButton_Functiom for IT 改好緊急
function ChangeLevel2(myObj){
  document.getElementById("ShowAlertText").innerHTML = "你選擇了【 " + myObj.name + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Setting").doc("IT").collection("Detail").doc(myObj.name).update({
        Level: 2,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadITitemList();
      
}

// ShowAlertButton_Functiom for C 改好緊急
function ChangeLevel2C(myObj){
  document.getElementById("ShowAlertTextC").innerHTML = "你選擇了【 " + myObj.name + " 】。請選擇更改的緊急度，或按取消退出";
  var db = firebase.firestore();
  db.collection("Setting").doc("Construction").collection("Detail").doc(myObj.name).update({
        Level: 2,
      })
      .then(function(docRef) {
        console.log("Update Successful");
        mdui.snackbar({
          message: '緊急度更改成功',
          position: 'bottom',
          timeout: 3000
        });
        
      })
      .catch(function(error) {
        console.error("Update Fail");
        mdui.snackbar({
          message: '緊急度更改失敗',
          position: 'bottom',
          timeout: 3000
        });
      });
      ReadConstructionitemList();
      
}

// event for AlertDeleteBox for C 
var deletelogC = document.getElementById('deletelogC');

deletelogC.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

deletelogC.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

deletelogC.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

deletelogC.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

deletelogC.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

deletelogC.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

// event for AlertDeleteBox for IT 
var deletelog = document.getElementById('deletelog');

deletelog.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

deletelog.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

deletelog.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

deletelog.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

deletelog.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

deletelog.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

// event for AlertDeleteBox for Location 
var deletelogLocation = document.getElementById('deletelogLocation');

deletelogLocation.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

deletelogLocation.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

deletelogLocation.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

deletelogLocation.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

deletelogLocation.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

deletelogLocation.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

// event for AlertBox for IT 
var dialog = document.getElementById('dialog');

dialog.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

dialog.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

dialog.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

dialog.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

dialog.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

dialog.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});
 
// event for AlertBox for C 
var dialogC = document.getElementById('dialogC');

dialogC.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

dialogC.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

dialogC.addEventListener('close.mdui.dialog', function () {
  console.log('close');
});

dialogC.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

dialogC.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

dialogC.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

// event for Login Box 
var Logindialog = document.getElementById('Logindialog');

Logindialog.addEventListener('open.mdui.dialog', function () {
  console.log('open');
});

Logindialog.addEventListener('opened.mdui.dialog', function () {
  console.log('opened');
});

Logindialog.addEventListener('close.mdui.dialog', function () {
  console.log('close');
  firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        // User is signed in.
      }else {
        ShowLoginAlert();
        login();
        };
    });
});

Logindialog.addEventListener('closed.mdui.dialog', function () {
  console.log('closed');
});

Logindialog.addEventListener('cancel.mdui.dialog', function () {
  console.log('cancel');
});

Logindialog.addEventListener('confirm.mdui.dialog', function () {
  console.log('confirm');
});

  </script>

  </body>
</html>
